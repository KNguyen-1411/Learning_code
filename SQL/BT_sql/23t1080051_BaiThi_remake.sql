--Cau 3: Hiển thị mã vật tư, tên vật tư và nước sản xuất của các vật tư mà trong  tên có chữ --Bóng đèn và được sản xuất tại Việt Nam. Select * From VatTu Where TenVatTu Like N'Bóng đèn%' and NuocSuanXuat=N'Việt Nam'--Cau 4: Hãy cho biết họ tên của những người đã thực hiện việc lập phiếu xuất vật tư trong --khoảng thời gian từ ngày 01/05/2023 đến 15/05/2023  select * From PhieuXuatVatTu Where NgayLapPhieu between '2023-05-01' and '2023-05-15'--Cau 5:  Hiển thị mã vật tư, tên vật tư và nước sản xuất của các vật tư được sản xuất bởi các --nước trong danh sách sau: Việt Nam, Nhật, Đức, Pháp.Select * from VatTuWhere NuocSuanXuat in (N'Việt Nam',N'Nhật',N'Đức',N'Pháp')--Cau 6: Hiển thị mã vật tư, tên vật tư, nước sản xuất và số lượng của các vật tư được xuất --trong phiếu xuất có mã số là P003. SELECT  *FROM  VatTu AS vt	JOIN ChiTietPhieuXuatVatTu AS ct ON vt.MaVatTu = ct.MaVatTu		and ct.SoPhieu = 'P003'--Cau 7: Thống kê số lượng phiếu xuất mà mỗi người đã lập trong năm 2023select p.NguoiLapPhieu,	count(p.SoPhieu) as SoDonfrom PhieuXuatVatTu as pGroup by p.NguoiLapPhieu--Cau 8: Cho biết mã vật tư, tên vật tư và tổng số lượng đã xuất của mỗi vật tư. Yêu cầu kết quả --thống kê phải hiển thị đầy đủ tất cả các vật tư, những vật tư chưa từng được xuất cũng phải được hiển thị --với tổng số lượng đã xuất là 0. SELECT  vt.MaVatTu, vt.TenVatTu, ISNULL(SUM(ct.SoLuong),0) AS TongSoLuongXuatFROM	VatTu AS vt	    LEFT JOIN ChiTietPhieuXuatVatTu AS ct ON vt.MaVatTu = ct.MaVatTuGROUP BY vt.MaVatTu, vt.TenVatTu--Cau 9: Hãy cho biết số phiếu và ngày lập phiếu của những phiếu xuất được lập bởi người đã --lập phiếu xuất có mã số là P001.SELECT	SoPhieu, NgayLapPhieu   FROM	PhieuXuatVatTuWHERE	NguoiLapPhieu = (SELECT NguoiLapPhieu 							FROM PhieuXuatVatTu WHERE SoPhieu = 'P001')--Cau 10:  Hãy cho biết mã vật tư, tên vật tư và tổng số lượng đã xuất của những vật tư có tổng --số lượng đã xuất nhiều nhất. SELECT  vt.MaVatTu, vt.TenVatTu, SUM(ct.SoLuong) AS TongSoLuongXuatFROM    VatTu AS vt        JOIN ChiTietPhieuXuatVatTu AS ct ON vt.MaVatTu = ct.MaVatTuGROUP BY vt.MaVatTu, vt.TenVatTuHAVING SUM(ct.SoLuong) =         (               SELECT TOP(1) SUM(SoLuong)               FROM ChiTietPhieuXuatVatTu               GROUP BY MaVatTu                ORDER BY 1 DESC        )--Cau 11: Cập nhật cột SoLuong của bảng ChiTietPhieuXuatVatTu, tăng số lượng vật tư được --xuất lên gấp đôi cho các phiếu xuất được lập vào ngày 15/05/2023.UPDATE ChiTietPhieuXuatVatTuSET SoLuong = SoLuong * 2WHERE SoPhieu IN (  SELECT SoPhieu  FROM PhieuXuatVatTu  WHERE CONVERT(date, NgayLapPhieu) = '2023-05-15')--Cau 12: Thêm cột và cập nhật giá trị TongDaXuat của bảng VatTu bằng với tổng số lượng đã xuất của mỗi vật tư.    	--Thêm CộtALTER TABLE VatTuADD TongVatTu INT 	--Cập Nhật Giá TrịUPDATE VatTuSET TongVatTu = (  SELECT SUM(ISNULL(c.SoLuong, 0))  FROM VatTu AS v  LEFT JOIN ChiTietPhieuXuatVatTu AS c  ON v.MaVatTu = c.MaVatTu  WHERE v.MaVatTu = VatTu.MaVatTu  GROUP BY v.MaVatTu)